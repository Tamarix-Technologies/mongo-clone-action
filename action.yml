name: 'mongo-clone-action'
description: 'Github action to trigger mongoDB database clones via mongodump & mongorestore'
inputs:
  source:
    description: 'MongoDB connect url that includes username, password & database name you want to clone from'
    required: true
  target:
    description: 'MongoDB connect url that includes username, password & database name you want to clone to'
    required: true
runs:
  using: "composite"
  steps:
    #- name: Install dependencies
    #  shell: bash
    #  run: |
    #    python -m pip install --upgrade pip
    #    pip install flake8 pytest
    #    cd ${{ github.action_path }}
    #    if [ -f requirements.txt ]; then pip install -r requirements.txt; fi
    - name: Setup Node.js environment
      uses: actions/setup-node@v3.5.1
    - name: Install dependencies
      run: |
        cd ${{ github.action_path }}
        npm install package-lock.json
      shell: bash
    #- name: Clone Database
    #  run: ${{ github.action_path }}/clone.sh ${{ inputs.source }} ${{ inputs.target }}
    #  shell: bash
    - name: Anonymize Database
      run: |
        cd ${{ github.action_path }}
        ./anonymize.sh ${{ inputs.source }} ${{ inputs.target }}
      shell: bash
branding:
  icon: 'server'
  color: 'gray-dark'
